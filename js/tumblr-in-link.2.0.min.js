(function(){var a=new Object();var j=[];var q=[];var n=[];var k=[];var m=[];var l=[];var p=jQuery.noConflict();var d=document.getElementsByTagName("script");var h=d[d.length-1];var c=h.src.replace(/^[^\?]+\??/,"").split("&");var o=((typeof(a.url)=="undefined")?("http://"+document.domain+"/"):("http://"+a.url+"/"));for(var g=0;g<c.length;g++){var f=c[g].split("=");a[f[0]]=unescape(f[1])}if(typeof(a.tags)=="undefined"){error(0);return}if(typeof(a.num)=="undefined"){a.num=8}if(typeof(a.len)=="undefined"){a.len=60}if(typeof(a.size)=="undefined"){a.size=100}if(typeof(a.title)=="undefined"){a.title="Related Posts:"}if(typeof(a.imageurl)=="undefined"){a.imageurl="http://tumblr-in-link.googlecode.com/svn/branches/Version 2.0/img/placeholder.jpg"}if(typeof(a.type)=="undefined"){a.type=""}switch(a.css){case ("simple"):document.write('<link rel="stylesheet" type="text/css" href="http://tumblr-in-link.googlecode.com/svn/branches/Version 2.0/css/simple.css" media="screen" />');break;case ("complete"):document.write('<link rel="stylesheet" type="text/css" href="http://tumblr-in-link.googlecode.com/svn/branches/Version 2.0/css/complete.css" media="screen" />');break;case ("light"):document.write('<link rel="stylesheet" type="text/css" href="http://tumblr-in-link.googlecode.com/svn/branches/Version 2.0/css/light.css" media="screen" />');break;case ("dark"):document.write('<link rel="stylesheet" type="text/css" href="http://tumblr-in-link.googlecode.com/svn/branches/Version 2.0/css/dark.css" media="screen" />');break;case ("shadow"):document.write('<link rel="stylesheet" type="text/css" href="http://tumblr-in-link.googlecode.com/svn/branches/Version 2.0/css/shadow.css" media="screen" />');break}document.write('<div id="tumblrinlink"><div id="inlink-loading">Loading Tumblr In Links...</div><div id="inlink-title"></div><ul id="inlink-list"></ul><div id="inlink-logo"><a href="http://tech.gayspirit.me/in-link" title="In-Link Widget"><img src="http://tumblr-in-link.googlecode.com/svn/trunk/img/in-link-sm.png" alt="Tumblr In-Link"></a></div></div>');var r=a.tags.slice(0,-1).split(",");p(document).ready(function(){function s(){var u;for(var t=0;t<r.length;t++){u=p.getJSON("http://api.tumblr.com/v2/blog/"+document.domain+"/posts?api_key=VspHunyBAE3ZhmnivmJ7F8AMZX84Ptz96XCHGCdCRyg0DLNKif&limit="+a.num+"&offset=0&type="+a.type+"&tag="+escape(r[t])+"&jsonp=?",function(v){p(v.response.posts).each(function(y,x){var D="";if(x.type=="text"){D+=x.title}else{if(x.type=="link"){D+=x.title}else{if(x.type=="chat"){D+=x.body}else{if(x.type=="quote"){D+=x.text}else{if(x.type=="photo"){D+=x.caption}else{if(x.type=="video"){D+=x.caption}else{if(x.type=="audio"){D+=x.caption}else{if(x.type=="answer"){D+=x.question}}}}}}}}var w=D.replace(/(<([^>]+)>)/ig,"");if(w.length>a.len){w=w.slice(0,a.len);w+="..."}var A="";if(x.type=="text"){var C=x.body;var B=p(C);A+=B.find("img").attr("src")}else{if(x.type=="audio"){A+=this.album_art}else{if(x.type=="photo"){p(this.photos[0]).each(function(F,E){p(this.alt_sizes).each(function(H,G){if(a.size=="75"){if(G.width=="75"){A+=G.url}}if(a.size=="100"){if(G.width=="100"){A+=G.url}}if(a.size=="250"){if(G.width=="250"){A+=G.url}}})})}else{if(x.type=="link"){A+=0}else{if(x.type=="chat"){A+=0}else{if(x.type=="quote"){A+=0}else{if(x.type=="photo"){A+=0}else{if(x.type=="answer"){A+=0}}}}}}}}if(A==0){A=a.imageurl}else{if(A=="undefined"){A=a.imageurl}}var z="";z+=x.note_count;if(z=="undefined"){z="0"}n.push(A);j.push(w);q.push(x.post_url);l.push(x.type);k.push(z)})}).complete(i)}}function i(){for(var u=0;u<j.length;u++){var w=new RegExp("("+q[u]+")");var t=p("#inlink-list").html();if(q[u]!=document.location&&!t.match(w)){if(a.num--<=0){return}var v='<li class="inlink-item" id="'+l[u]+'"><div class="shade1"><div class="shade2"><div class="shade3"><div class="clipout"><div class="clipin"><a class="inlink-link" href="'+q[u]+'" title="'+j[u]+'"><img src="'+n[u]+'" alt="'+j[u]+'"><div class="notes"></div></div></div></div></div></div><p>'+j[u]+' <span id="#notes" class="notes" style="display:inline">&hearts;'+k[u]+"</span></p></a></li>";p("#inlink-list").append(v)}}if(q.length==0){e()}console.log(q.length);p("#inlink-title").html("<h2>"+a.title+"</h2>");p("#inlink-loading").html("")}s()});function b(i){var s="error: ";switch(i){case 0:s+="no tags defined";break;case 1:s+="tumblr API problem";break;case 2:s+="tumblr problem";break}p("#inlink-loading").html(s)}function e(){p("#tumblrinlink").hide()}})();